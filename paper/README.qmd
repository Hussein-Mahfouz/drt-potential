---
title: "Exploring the Potential for Integrating Demand Responsive Transport with Public Transport"
author: "Hussein Mahfouz"
abstract: "Demand-Responsive Transport (DRT) has emerged as a mobility option for areas that are traditionally hard to serve by high frequency public transport. The integration of DRT with public transport could help reduce car mode share, but planning DRT remains challenging; many studies show that DRT can inadvertently reduce public transport demand while also increasing congestion and vehicle-miles traveled (VMT).  More research is needed on how to constrain operating areas of DRT based on the unique demand patterns of an area. This work investigates delineating service areas of DRT using spatial clustering of spatial flow data. A density-based clustering method for bivariate flows is used to study commuting patterns by car and public transport in the city of Leeds. We consider clusters based on (a) Origin-Destinations (OD) pairs with poor public transport supply, and (b) OD pairs with poor public transport supply and low potential demand. The method identifies clusters of flow where demand is concentrated, and suggests potential DRT zones based on the results. Identifying concentrated demand clusters can help address one of the main reasons for high DRT failure rates --- unnecessarily flexible ‘many-to-many’ services --- by constraining the service to clusters with high car use. The areas identified provide a useful input into additional work, including visualisation to communicate decision-making, and simulations that aim to further refine the operating characteristics of DRT. Our approach provides a foundation for agent-based models of DRT and future research into and practical applications of DRT integration with existing public transport systems."
date: "`r format(Sys.time(), '%d %m %y')`"
format:
  #gfm: default
  html:
    toc: true
  # docx:
  #   toc: false
  #   number-sections: true
  # pdf:
  #   toc: false
  #   number-sections: false
  #   extra_dependencies: ["float"]
    #pdf-engine: pdflatex
keep-tex: true
bibliography: lit-review.bib
# elsevier style for referencing (from https://github.com/citation-style-language/styles)
csl: elsevier-harvard.csl
# so that figures don't float around
# include-in-header:
#  \usepackage{float}
#  \floatplacement{figure}{H}
 # to add acronyms (only works for pdf output)
filters:
  - pseudocode
---

```{r, include = FALSE}
#library(tidyverse)
knitr::opts_chunk$set(fig.pos = "H", out.extra = "")
```

# Introduction {#sec-intro}

Bus networks form the backbone of many transit systems across the world. They can offer equitable access to low cost mobility (an aspect that is important for social inclusion), mitigate against congestion, and reduce emissions resulting from increased car dependence. In many cities, bus services have grown gradually to meet increasing demand from the expanding urban core and peripheries, but the quality of service can suffer from issues such as poor access between neighborhoods, inconvenient geometric structures and poor route synchronization [@ruiz2017improving]. Existing research has been conducted on strategic and tactical redesign of bus networks to increase their attractiveness [@kepaptsoglou2009transit; @ibarra2015planning; @liu2021review]. However, advanced optimisation approaches cannot make up for the fact that traditional bus services are most suited to dense areas with consistently high demand [@errico2013survey] and are inefficient for suburban areas, villages, and low demand interurban areas [@papanikolaou2017methodological].

Flexible mobility services, such as Demand Responsive Transport (DRT), have been proposed to serve such areas. We follow @davison2014survey in defining DRT: a service that is (a) available to the general public, (b) provided by low capacity vehicles (relative to buses), (c) responsive to changes in demand, and (d) has a fare that is charged per passenger, not per vehicle. While DRT systems have a higher fixed cost per passenger than FRT [@currie2020most], they aim to compensate for this by reducing operating costs through higher passenger load factors with minimal increase to service distance due to route circuity [@ryley2014investigating]. This balance is difficult to achieve, and even now as technological improvements drive a re-emergence of DRT, failure rates are high and strongly correlated with operating costs [@currie2020most].

Extensive research has been done on DRT planning, but the focus is more on the tactical and operational level and less on the strategic level [@papanikolaou2017methodological]. Strategic level methods that help identify potential DRT operating zones are important given that one of the main determinants of success for a DRT scheme is its ability to concentrate demand geographically and temporally [@enoch2006demand]. Previous work has used accessibility scores to identify potential DRT service areas [@giuffrida2021addressing; @rath2023assessing], but this approach assumes that there is no room for improvements in the existing FRT service.

This study makes both conceptual and methodological contributions to the strategic level planning of DRT services. Conceptually, it fills a important gap in strategic DRT planning by addressing an unexplored area: the identification of clusters in commuting flows and their implications for DRT service operating areas. This conceptual advancement provides a new perspective on how to approach DRT planning at a strategic level. Methodologically, the study introduces a spatial statistical approach to cluster spatial flow data [@tao2016spatial], and combines it with an assessment of transport supply and demand to identify areas with concentrated travel demand suitable for DRT services. This framework ensures that DRT is not proposed in areas (a) where there is no concentrated demand, and (b) where an improved Fixed Route Transit (FRT) would be more appropriate. While methods for spatial clustering of flow data are heavily studied in spatial data mining, to our knowledge this is the first paper employing them for strategic DRT planning.

<!--# The rest of this paper is structured as follows. In @sec-lit-review, we provide a formal definition of DRT, give an overview of DRT planning and the importance of complementing the existing FRT network, and introduce methods for spatial clustering of flow data that we propose to use in identifying potential DRT service areas. In @sec-methods, we explain how to we identify poorly served origin-destination (OD) pairs using transport supply and demand analysis, and then go into the details of the spatial clustering approach and how it is used on these OD pairs. -->

<!--# For DRT to be successful, it should be part of an integrated public transport offering that provides a competitive alternative to private car use. The aims of this research are to (a) develop methods to identify demand gaps in public transport provision that can be filled by DRT, and to (b) understand the potential benefits and issues of integrating DRT with existing public transport systems through simulation-based approaches. -->

# Literature Review {#sec-lit-review}

## Demand Responsive Transport (DRT) {#sec-drt-overview}

<!--# It can be distinguished from traditional fixed route services through: (a) network typology and operation, (b) boarding and alighting locations, (c) schedule, and (d) advanced notice requirement [@papanikolaou2017methodological] -->

The concept of DRT goes back to the 1970s, and it has taken other names such as Dial-a-Bus, or more recently, micro-transit [@currie2020most]. It is seen as a compromise between the convenience (instant frequency and full coverage) of the automobile, and the cost-effectiveness of public transport [@currie2020most]. Useful diagrams have been made to compare DRT to other travel modes in terms of trade-offs in service frequency --- coverage [@d1994demand] and flexibility --- sustainability [@inturri2019multi].

While the term DRT has become an umbrella term for flexible public transport, services can be grouped under different DRT typologies [@enoch2004intermode] or scheduling and operational characteristics [@d1994demand]. For diagrammatic descriptions of the different operational characteristics, the reader is referred to [@mageean2003evaluation; @pavanini2023role].

These different service offerings highlight the complexity of DRT planning. On the one hand, this flexibility allows DRT services to be tailored to the specific demand patterns of an area. Conversely, the overly complex services, or services that don't match the needs of the local community, are prone to failure [@enoch2006demand]. Choosing the wrong service could lead to bad user experience and unnecessarily expensive operating costs.

## Planning DRT systems {#sec-planning_drt}

The planning of public transport systems with conventional bus services is well established and follows a sequential approach [@ceder1986bus; @ibarra2015planning] that includes *strategic*, *tactical*, and *operational* planning. The high failure rate of DRT systems is related to the lack of a similar robust methodological planning framework for its appraisal [@papanikolaou2017methodological].

In trying to map DRT research onto these planning pillars, @papanikolaou2017methodological find that DRT research can be split into:

1.  Strategic level (economic and econometric studies) studies on DRT area selection and investment evaluations. This includes (a) Research outlining the potential market and operating model of DRT systems [@mulley2009flexible], and (b) Research that compares cost functions of DRT and public transport using analytical methods [@nourbakhsh2012structured].

2.  Tactical and and operational level (operations research) studies on system typology definition and operational characteristics (@vansteenwegen2022survey provide a review of this sub-field of the literature).

Whereas the latter is studied extensively, there remains a need to develop general approaches on identifying potential areas for DRT services [@papanikolaou2017methodological]. This has become more necessary as DRT systems evolve from being targeted at special groups (in parallel to conventional public transport), to being integrated with public transport with the aim of improving accessibility for entire communities [@nelson2010recent]. <!--# this should be grounded in accessibility, not something else … cite Tools of the Trade -->

### Importance of delineating DRT operating areas {#sec-lit-service-areas}

There are various elements of DRT operating characteristics that effect its uptake and the wider system, including fares, fleet size and rebalancing, operating zones (as well as wider changes to the system such as car tolls and public transport service levels). While studies have looked at scenarios with different fleet sizes and fare structures, the choice of operating zones is generally simplified. Analytical models exist for deciding whether areas should be served by a FRT or DRT, but these models are based on idealized representations at the route level with pre-defined service areas [@quadrifoglio2009methodology; @li2010feeder; @sivakumaran2012cost]. For these models to be applied in a real case study, it is important to take a step back to identify potential service areas in an actual network. 

Simulation-based approaches on real world networks have also been used to analyse potential DRT service areas. Research has looked at (a) splitting the study area into inner and outer city [@kaddoura2020impact], restricting service to zones that (b) have a low public transport accessibility [@rath2023assessing], or (c) are within a certain buffer distance from rail (with the intention for DRT to act as a feeder) [@oke2020evaluating]. These simulations have shown that, when allowed to operate across an entire city or region, the % of DRT users that are shifting from public transport can vary significantly, between 2% [@kagho2021demand] and 65% [@kaddoura2020impact]. A shift away from active travel is also seen when DRT is allowed to operate in dense urban cores [@kaddoura2020impact; @kagho2021demand; @rath2023assessing]. These shifts can be mitigated by excluding areas with high FRT accessibility (which normally includes the urban core) from the service area of DRT [@rath2023assessing]. The high variance in mode share results shows that generic rules based on accessibility levels cannot be applied to all cities, but that specific characteristics of travel demand need to be accounted for when defining operating zones.

<!--# mention the paper " a novel global urban typology framework for sustainable mobility futures, or just [@oke2020evaluating] -->

<!--# Effect of DRT on total vehicle-km and congestion -->

In addition, mode shift on it's own is not an indicator of more sustainable travel. A high DRT mode share could be the result of a large fleet size with high dead mileage or low-occupancy trips. Simulation results show that increases in congestion and system-wide total vehicle km are likely [@oke2020evaluating; @kagho2021demand; @rath2023assessing], even under scenarios which constrain operating areas [@rath2023assessing] or offer DRT as a feeder to mass transit [@oke2020evaluating].

Given these results, it has been suggested that DRT may only be effective in increasing sustainable travel when provided in areas with poor FRT level of service [@rath2023assessing]. Even so, in order to move towards a lower car mode share and reduce overall VMT, the service area needs to be informed by spatial and temporal demand in the region [@kagho2021demand]. In the following section, we explore methods for capturing these concentrations in demand from OD data.

## Identifying spatial concentrations in travel demand

Methods for visualising OD data do not necessarily capture spatial and temporal demand, and it can be hard to discern patterns due to the vast amount of data being represented [@guo2009flow]. Community detection [@guo2009flow] and edge bundling methods [@selassie2011divided] have been proposed to mitigate against visual clutter and salience bias, but the reduction of clutter comes at the expense of spatial information; in the former we lose spatial granularity, and in the latter we can no longer distinguish patterns in OD data. These two factors are important for our use case, so we choose to rely on methods that identify patterns in the raw OD data without altering it.

<!--# check "An OD clustering method based on vector constraints:  2.1: Visuaising OD flow-->

<!--# from: Detecting arbitrarily shaped clusters in origin-destinatin flows using ant colony optimisation -->

Clustering has emerged as a method for spatial pattern identification in OD data. Clustering methods can be divided into two groups [@song2019detecting]: (1) spatial statistics-based methods, and (2) hierarchical and density based clustering methods. The former use methods for anomaly detection based on tests of spatial homogeneity (such as Moran's I, Getis-Ord G statistic, and Ripley's K) and extends these methods from point data to OD data. While they can detect the presence of clusters at different spatial scales, they do not actually group the data into clusters. The latter are able to group the data based on distance measures between the OD flows.

Density-based clustering is a popular technique for discovering precise clusters in space. *Density-based spatial clustering of applications with noise* (DBSCAN) [@ester1996density] is one of the most popular density-based clustering algorithms, but variations such as Hierarchical density-based clustering (HDBSCAN) [@campello2013density] and OPTICS (*Ordering Points To Identify the Clustering Structure*) [@ankerst1999optics] are also commonly used. These algorithms rely on distances between observations, a metric that is easy to calculate for point data, but less intuitive for other geometries such as lines due to the multilocation nature of each geometry. @tao2016spatial devise measures to calculate distance between lines, and this has paved the way for these algorithms to be applied to flow data [@tao2016dbscan; @tao2017flowhdbscan; @fang2021adaptive]. Different approaches have also been proposed for adding a temporal dimension to the cluster detection [@yao2018stepwise].

The ability of these algorithms to cluster flow data without loss of spatial information (as is the case with edge bundling) is invaluable for understanding the spatial concentrations of demand that exist in a network. This research makes use of density-based clustering as part of a larger approach to identify concentrations in travel demand that could be served by DRT.

<!--##### CONGESTION AND VKT  -->

<!--# Simulation results show that DRT increases total Vehicle km and congestion (even if it decreases car use) -> "In summary, we find that AMoD under any strategy will increase VKT and congestion in either city type." - [@oke2020evaluating]  —— study looks at wide-scale rollout. Scenarios (AmoD intro, AMoD no transit, and AMoD transit integration) analyse DRT roll-out across a city.  —— Last scenario restricts to short trips. 7.5 mile short trips and 7.5 mile radius/ around rail stops -> quite a large catchment. ADD A HISTOGRAM WITH TRIP DISTANCE TRAVELLED BY MODE in study area; lets see what % of car/pt trips by mode we are capturing with this constraint  -->

<!--# Increased VKT in specific areas. Change is not homogeneous across the network [@kagho2021demand] -->

<!--# VKT goes up in all scenarios (scenarios are combinations of fleet size and fare) -->

<!--# "The DRT service in this paper covers the whole study region. Therefore, it is hard to meet pick-up constraints, as the service is spread thin within the region. Idle vehicles are unable to service requests that are too far away from where the vehicle is currently waiting. Using the spatial and temporal information on the demand in the whole region, it would be possible to optimize the service area to increase the share of pooled rides, and potentially to create a service that is able to reduce VKT in the region." [@kagho2021demand] -->

<!--# [@rath2023assessing] "For a city, it is questionable if AToD is a suitable addition to the existing modes. Especially for cities where car travel is increasingly discouraged by the government, as is the case for Zurich (NZZ, Neue Zürcher Zeitung, 2017), AToD does not seem a suitable alternative. Rather it is a service that can be attractive for rural municipalities where PT is offered at a low level of service and operates inefficiently, as regulated in Scenarios 3 and 6." ———> but if we serve rural areas, we need to be targeted so that the service is not spread too thin [@kagho2021demand] -->

# Methods {#sec-methods}

Experts agree that DRT service provision should be based on demand [@dft2020regulatory]. However, there are no agreed upon methods for how demand gaps that suit DRT can be identified in a way that allows it to be well-iintegrated with public transport.

In this section we go over a proposed approach to identify gaps in public transport provision and cluster demand from these gaps in order to inform potential DRT operating zones. First, we show how demand gaps can be identified through a supply and demand analysis; In @sec-method-transport-supply we show how public transport supply is calculated and define poor public transport supply, and in @sec-method-transport-demand, we explain potential demand and how it is calculated.

In @sec-method-clustering-flow-data, we introduce a clustering approach for determining how travel demand is concentrated geographically. We apply the algorithm on two different datasets obtained using the methods in @sec-methods-preparing-data: 1) OD pairs with poor public transport supply, and 2) OD pairs with poor public transport supply and low potential demand . The entire workflow is presented in @fig-workflow.

We present our case study city in @sec-case-study

![Workflow for generating potential DRT zones](images/figure_entire_workflow.png){#fig-workflow width="1200"}

## Preparing input data for clustering {#sec-methods-preparing-data}

For our analysis, we use OD commuting (flow) data from the 2021 UK census to represent travel demand [@ons2023flow]. Before attempting to cluster our OD data, we need to decide which OD pairs to use. If we were to pass all OD pairs to the algorithm, then our clusters may include noise from OD pairs that are well served by public transport. We would also generate DRT zones that serve all demand, whereas our objective is to come up with DRT zones that complement FRT and fill the gaps in the network, as explained in @sec-lit-service-areas. We identify gaps by trying two different inputs: (1) OD pairs with poor public transport supply ($OD_s$) , and (2) OD pairs with poor public transport supply and low potential demand ($OD_{sd}$).

$OD_s$ is meant to suggest DRT zones that complement FRT by only including the OD demand that is not well served by FRT, as explained in @sec-method-transport-supply. $OD_{sd}$ is similar, but also excludes OD pairs that could be served by a better FRT service. This exclusion is based on criteria explained in @sec-method-transport-demand. The workflow for the supply and demand analysis is shown in @fig-flowchart-scenarios. The number of OD pairs in each approach is shown in @tbl-od_pairs_scenarios.

![Flowchart for determining input to clustering algorithm](images/flowchart_od_potential_demand.png){#fig-flowchart-scenarios alt="Flowchart for determining input to clustering algorithm"}

### Supply analysis {#sec-method-transport-supply}

A supply analysis is carried out to determine the OD pairs that are included in $OD_{s}$. The main components of transport supply are the road network, and the public transport timetables for buses and rail. We get the updated road network from OpenStreetMap. Bus timetable data is obtained in GTFS format from the Bus Open Data Service (BODS)[^1] and rail data is obtained from the Rail Delivery Group[^2].

[^1]: https://data.bus-data.dft.gov.uk/

[^2]: https://data.atoc.org/

The OSM road network and timetable data are fed into a multimodal routing engine [@pereira2021r5r] to calculate travel time between zones. Euclidean distance between an OD pair is used to calculate travel speed $(v_{ij})$. OD pairs with speed below the 50th percentile or that require more than one transfer to be reached by public transport are considered to have poor supply.

### Demand analysis {#sec-method-transport-demand}

Our transport demand analysis is meant to identify FRT routes that warrant an increase in route frequency. We calculate potential demand on all routes, and identify routes that have sufficient potential demand to warrant said increase in frequency. Potential demand is defined here as the demand along a bus route that could theoretically be served by the route. We only look at existing travel patterns and do not consider induced demand that could results from a better bus service.

To calculate potential demand on all routes, we do the following:

1.  *Determine which public transport routes directly serve each OD pair*: A route that directly serves an OD pair is a route that passes through both the origin and the destination zones associated with the OD pair. There can be multiple routes (common lines) serving each OD pair

2.  *Assign demand from OD pairs onto the bus routes*: Our flow data has commuting flows by mode for all Middle Super Output Area (MSOA[^3]) pairs. We distribute demand from each OD pair onto its common lines (see @de2024modelling10 for overview of methods). We split the demand equally between common lines. Frequency-based assignment[^4] may better represent the status quo, but we chose to split the demand equally as our goal is to represent what the demand could be if route frequencies were improved.

3.  Get total potential demand on each route by summing the demand assigned from each OD pair

[^3]: MSOAs are geographical areas created by the Office for National Statistics (ONS). Each MSOA has between 5,000 - 15,000 people

[^4]: Demand is distributed between the common lines (routes) in proportion to the frequency of each route

To determine which OD pairs we want in our analysis ($OD_{sd}$), we compare the potential demand on all routes. For each OD, we (a) get potential demand on all routes directly serving it. If potential demand on the busiest direct route serving OD \> 75th percentile of route demand, we don't include it in $OD_{sd}$ (see @fig-flowchart-scenarios).

OD pairs with high potential demand are not included in $OD_{sd}$ as there is sufficient demand to justify a high frequency FRT, even if one does not currently exist. The heuristic for calculating potential demand allows us to avoid serving areas with DRT just because there is poor FRT supply; there must also be insufficient demand to warrant a high frequency FRT.

Setting the threshold at $p75$ implies that service on the top 25% of routes in terms of potential demand will be improved so that they are all high-frequency routes. In reality, this % could be edited based on the budget available for additional buses.

::: columns
::: {.column width="50%"}
| Name       | No. of OD pairs |
|------------|-----------------|
| $OD_{all}$ | 10,506 (100%)   |
| $OD_{s}$   | 10,130 (96%)    |
| $OD_{sd}$  | 7,876 (75%)     |

: Number of OD pairs in after each step {#tbl-od_pairs_scenarios}
:::
:::

<!--# TODO: add pseudocode https://github.com/leovan/quarto-pseudocode -->

<!-- ``` {#pseudocode-demand-analysis .pseudocode} -->

<!-- #| label: alg-test-text-style -->

<!-- #| html-indent-size: "1.2em" -->

<!-- #| html-comment-delimiter: "//" -->

<!-- #| html-line-number: true -->

<!-- #| html-line-number-punc: ":" -->

<!-- #| html-no-end: false -->

<!-- #| pdf-placement: "htb!" -->

<!-- #| pdf-line-number: true -->

<!-- \begin{algorithm} -->

<!-- \caption{Identify OD Pairs with LOW Potential Demand} -->

<!-- \begin{algorithmic}[1] -->

<!-- \STATE \textbf{Input:}  -->

<!-- \STATE $OD = \{OD_1, OD_2, ..., OD_i, OD_m\}$: All OD pairs -->

<!-- \STATE $R = \{R_1, R_2, ..., R_j, R_n\}$: Public transport routes:  -->

<!-- \STATE \textbf{Output:} -->

<!-- \STATE $OD_{low}$: OD pairs with low potential demand -->

<!-- \STATE // Step 1: Determine direct routes serving each OD pair -->

<!-- \FOR{each OD pair $OD_i \in OD$} -->

<!--     \STATE // Determine which public transport routes directly serve it -->

<!--     \STATE $R^i$: list of PT routes serving $OD_i$ -->

<!-- \ENDFOR -->

<!-- \STATE // Step 2: Assign demand from OD pairs onto the bus routes -->

<!-- \FOR{each OD pair $OD_i \in OD$} -->

<!--     \STATE // Method 1: All to All (Assigning all OD demand to all routes)  -->

<!--     \IF{method = All-to-All} -->

<!--         \FOR{each $R^{i}_{j} \in R^{i}$} -->

<!--             \STATE Demand $R^{i}_{j}$ = Demand $OD_i$ -->

<!--         \ENDFOR -->

<!--     \STATE // Method 2: Assigning demand to routes based on their frequency -->

<!--     \ELSIF{method = Frequency-Based} -->

<!--         \FOR{each $R^{i}_{j} \in R^{i}$} -->

<!--             \STATE Demand $R^{i}_{j} = \frac{\text{Demand } OD_i \times \text{Freq}(R^{i}_{j})}{\sum_{j} \text{Freq}(R^{i}_{j})}$ -->

<!--         \ENDFOR -->

<!--     \STATE // Method 3: Assigning demand equally between routes -->

<!--     \ELSIF{method = Equal Split} -->

<!--         \FOR{each $R^{i}_{j} \in R^{i}$} -->

<!--             \STATE Demand $R^{i}_{j} = \frac{\text{Demand } OD_i}{\lvert R^i \rvert}$ -->

<!--         \ENDFOR -->

<!--     \ENDIF -->

<!-- \ENDFOR -->

<!-- \STATE // Calculate total demand on each route -->

<!-- \State $\text{Demand } R_j = \sum_{i} \text{Demand } R^{i}_{j}$ -->

<!-- \STATE // Step 3: Identify OD pairs with potential demand -->

<!-- \FOR{each OD pair $OD_i \in OD$} -->

<!--     \IF{Demand on busiest route in $R^{i} > p_{50} \text{ Demand in } R$} -->

<!--         \STATE // Remove $OD_i$ from OD -->

<!--         \State $OD_{low} = OD - \{OD_{i}\}$ -->

<!--     \ENDIF -->

<!-- \ENDFOR -->

<!-- \end{algorithmic} -->

<!-- \end{algorithm} -->

<!-- ``` -->

### Jittering

Our OD data is aggregated at MSOA level which makes it too coarse for our clustering analysis. We apply jittering [@lovelace2022jittering] to disaggregate the data so that OD pairs with a high number of commuters are split into multiple OD pairs. The start and end points of the new ODs are constrained to their original MSOAs, but are snapped to locations probabilistically based on population and employment densities. A disaggregation threshold is also specified so that no OD pair has more than 100 commuters.

## Clustering flow data {#sec-method-clustering-flow-data}

We apply a spatial clustering approach to flow data to identify spatial concentrations in travel demand. Spatial statistics methods for cluster detection --- such as DBSCAN [@ester1996density] - have mainly been developed for point data. Recently custom distance metrics that account for the multi-location nature of line data have allowed these methods to extend to flow data [@tao2016spatial].

We use the DBSCAN algorithm which takes two parameters: epsilon (the search radius to look for clusters) and minimum points (or minpts - the minimum number of points required to be inside a with the specified radius from a given point for a cluster to form around it). The distances between OD flows is calculated using the custom distance metric introduced by @tao2016spatial: let the flow process $F_{i}$ with origin $O_{i} (x_{i}, y_{i})$ and $D_{i} (u_{i}, v_{i})$ be modeled as a vector point with 4 coordinates $F_{i}(x_{i}, y_{i}, u_{i}, v_{i})$. The calculation for flow dissimilarity ($FDS_{ij}$) between $F_{i}$ and $F_{j}$ is shown in @eq-fds.

$$FDS_{ij} = \sqrt{\frac{\alpha[(x_{i} - x_{j})^2 + (y_{i} - y_{j})^2] + \beta [(u_{i} - u_{j})^2 + (v_{i} - v_{j})^2]}{L_{i}L_{j}}}$$ {#eq-fds}

where $\alpha$ and $\beta$ control the relative importance of the origins / destinations: higher $\alpha$ means we focus more on origins and vice-versa ($\alpha > 0$; $\beta > 0$; $\alpha + \beta = 2$). Dividing by the geometric mean of the flow lengths ($L_{i}$ and $L_{j}$ ) implies that, all else being equal, flow pairs of longer length are considered closer than shorter ones.

Our analysis looks at commuting flows by mode. Taking inspiration from @shu2022density, we study the composition of each cluster and determine the ratio of car to public transport users. Clusters with a low ratio of public transport to car users are considered initial candidates for DRT.

## Clusters to potential DRT zones

The clusters produced by our algorithm may return clusters that cover large geographical areas. These areas may, in turn, be partly served by high frequency FRT services. Having DRT cover the entirety of such areas may not be optimal as it (a) may provide competition to these FRT services, and (b) may necessitate complex operations that make the service more prone to failure (as mentioned in @sec-drt-overview).

We therefore propose a subsequent step to extract potential DRT zones from the obtained clusters. We get the spatial difference between each cluster and the high frequency FRT routes in the study area, leaving us with polygons that extend to but do not overlap with said routes. This is in line with a DRT service that acts as a complimentary first/last mile connector.

## Case Study {#sec-case-study}

The research will focus on the city of Leeds, UK as a case study. Leeds is the biggest city in West Yorkshire, and the one of the largest European cities without rapid transit. The rgional authority in charge of transport, the West Yorkshire Combined Authority (WYCA), has declared a climate emergency, and has put a target to reach net-zero by 2038. It has estimated that a significant mode shift will be needed to achieve this target, and has set a target of 52% increase in bus mode share [@wyca2021connectivity]. This is an ambitious target seeing as the decade between 2009-2019 saw a decrease of 15% (from 170 million to 144 million) in annual bus trips in the region. [@wyca2021improvement].

<!--# A recent report on bus services in Leeds highlighted that they were concentrated between two main operators, FirstBus (65.6%) and Arriva (26.1%), and that over 50% of routes in the city are likely to experience adverse effects of (a lack of) competition [@wyca2017bus]. The report highlights that bus operators are not a homogeneous group, and that there was no formal process for them to coordinate on plans and policies. In the Leeds Bradford area, 40% of population have access to only 1 bus per hour outside peak hours, and many areas have poor or non-existent access to rail [@wyca2021connectivity]. -->

Following the new powers given to local transport authorities under the bus services act [@uk2017busact], the West Yorkshire Bus Service Improvement Plan [@wyca2021improvement] has set ambitious targets for bus mode share, patronage, service provision (bus miles), journey times, as well as accessibility. The plan acknowledges that changes will need to be made to the network, which currently fails to meet user needs (due to a reduction in services and to routes being based on historic travel patterns) and is heavily subsidized [@wyca2021improvement]. A big part of the ambition is better integration of buses as part of a multimodal public transport offer. DRT is also seen as a means of providing more efficient access than traditional public transport to low-density areas; WYCA has already piloted such a service (Flexibus) in East Leeds [@wyca2021improvement], but during the 18 month pilot phase, the service was struggling to attract ridership and was only covering 5% of it's operating costs [@wyca2022drtflexibusreview]. An average number of customers per trip of 1.38 was in large part due to an inflexible service that only pooled people doing almost exactly the same route. More flexible services, along with an identification of spatial concentrations in travel demand, can help improve viability of DRT services.

![Urban Rural Classification - 1: most rural, 10: most urban](images/rural_urban.png){#fig-rural-urban alt="Urban Rural Classification - 1: most rural, 10: most urban"}

# Results

In this section we look at the clustering output of $OD_s$ and $OD_{sd}$. @sec-results-transport-supply and @sec-results-transport-demand presents the results for each respectively.

## Clustering based on transport supply {#sec-results-transport-supply}

<!-- ::: {#fig-transfers layout-nrow="1"} -->

<!-- ![Connectivity of OD pairs](images/map_desire_commuting_facet_transfers.png){#fig-od-transfers-1 width="502"} -->

<!-- ![Connectivity of OD pairs (bar plot)](images/plot_bar_transfers_stacked_distance.png){#fig-od-transfers-2 width="300"} -->

<!-- Transfers between OD pairs -->

<!-- ::: -->

@fig-cluster-scenario-2 shows the clustering results for the $OD_{s}$ input. Each facet in the plot represents one of the main clusters produced by the DBSCAN algorithm. The visual has many components

-   OD pairs: these are the straight lines with different colors. The different colors represent the fraction of car to bus users, while the line thickness represents the number of commuters in that OD pair.

-   Cluster area: Represented by the black dotted border, which is generated by getting the concave hull around the OD pairs in the cluster. The cluster area shows the spatial extent of the OD pairs that have been grouped together. We can see that some clusters appear quite similar, but open closer inspection we can see that they are distinct. For example clusters 1 and 5 have significant overlap, with both having OD pairs going from the North East to the South West. However, the OD pair at cluster 5 end before the center of Leeds, while those of cluster 1 extend beyond the center, reflecting two distinct commuting patterns.

-   Bus routes: High frequency bus routes are added as a background layer to give an overview of the current service

-   Potential DRT zones: These are created by getting the spatial difference between the cluster areas and the bus routes. They visualise the areas in each cluster that are not served by a high frequency bus route. They share the same color legend with the OD pairs, and the colors represent the average fraction of bus to car users for all OD pairs in the cluster

![Clustering results - OD pairs with poor PT supply ($OD_{s}$)](images/map_clusters_scenario_2_equal_length_50000_bus_frac_grouped_gtfs_poly_lines_bus_diff_concave2_crop.png){#fig-cluster-scenario-2}

If we compare the clusters to the spatial distribution of urbanisation (@fig-rural-urban), we find that most of the clusters are connecting areas with different levels of urbanisation, and that an area with high levels of urbanisation is always involved. For example clusters 1, 5, and 8 connect somewhat rural areas in the North East to the urban major conurbation[^5]. Clusters 7, 11 and 12 do the same in the South East. Other clusters, such as 3, 9, and 10 are mainly inside the most urbanised areas.

[^5]: The classifications are explained in the [2011 Rural Urban Classification User Guide](https://www.gov.uk/government/statistics/2011-rural-urban-classification)

## Clustering based on transport supply and demand {#sec-results-transport-demand}

The results are similar to those of $OD_s$, but we see that some clusters in the South-East disappear. This is an indicator that there may be enough demand in the South East to warrant a high frequency bus service. Similarly, we see that cluster 3 in @fig-cluster-scenario-2 has no equivalent in @fig-cluster-scenario-3. The cluster were located in a high density area which seemed to overlap with many bus routes, so it is not surprising that there is sufficient demand in the area to warrant improved FRT service.

In most cases, the clusters partially overlap with the high frequency FRT services, but that is because the FRT service does not meet the demand at its endpoints. As mentioned previously, a DRT service in these cases would be more useful as a connector to the FRT service, not as a parallel service.

![Clustering results - OD pairs with poor PT supply and low potential demand ($OD_{sd}$)](images/map_clusters_scenario_3_equal_length_50000_bus_frac_grouped_gtfs_poly_lines_bus_diff_concave2_crop.png){#fig-cluster-scenario-3}

Overall, we see that many of the clusters join up the urban core with its rural periphery. This is in line with research showing that DRT services can be used to efficiently compliment FRT systems that extend to rural areas [@sorensen2021much; @schluter2021impact]. As mentioned in @sec-intro, the ability of DRT schemes to concentrate demand in time and geography improves their likelihood of success.

Noticeably, clusters made up of longer distance OD flows show more variance in their directionality (e.g. cluster 4 in @fig-cluster-scenario-3). They tend to be anchored at one end and dispersed at the other. Shorter distance OD flows appear to have less circular variance and exhibit better concentration of demand at both endpoints. This is a result of our distance metric ([@eq-fds]) which normalizes distances by the length of the OD flows, thereby making longer flows appear closer than shorter ones.

Comparing the original clusters to the extracted DRT operating zones, we see how the latter cover much less urban areas than the former [@fig-cluster-stats]. The operating zones are meant to connect to the high frequency FRT network, and limiting the DRT service to the urban periphery is important for limiting unnecessary mode shift (as mentioned earlier).

The clusters vary in their composition, as shown in @fig-cluster-stats. Some clusters are made up of many OD pairs each of which has a relatively small number of commuters (e.g cluster 6) whereas others are have a few OD pairs with a large number of commuters (e.g cluster ...). The composition of the clusters (along with it's spatial extent) can inform the type of DRT services [@d1994demand] to offer in each zone; a small number of high demand OD pairs could be served by a more direct service, whereas a cluster with many different, low demand, OD pairs would be better served by a more flexible, many-to-many service. Clusters with a mix of high and low demand OD pairs may be better served by multiple DRT fleets with different operational characteristics.

::: {#fig-cluster-stats layout-ncol="2"}
![](images/figure_bar_urban_rural_compare_filter_no_filter_facet_cluster_scenario_3_length_50000.png){width="300"}

![](images/figure_scatter_commuters_color_speed_facet_cluster_scenario_3_length_50000.png){width="300"}

Left: Classification of areas covered by each \| Right: Characteristics of OD pairs in each cluster (light grey are all OD pairs and dark grey are all OD pairs in the cluster with no viable public transport option)
:::

@fig-zones-one-map gives an overview of how the zones could be merged based on the needs of the different clusters. It becomes more clear that the zones are predominantly in the outskirts and in areas with relatively low population densities. Zones in more urbanised areas, such as that in the South West covers an area with no public transport.

![Potential DRT zones](images/map_clusters_scenario_3_equal_length_50000_bus_frac_grouped_gtfs_poly_bus_diff_concave_pop_density_one_map_overline.png){#fig-zones-one-map}

<!--# Point on limitations from Song 2019 -->

<!--# "Many studies have made contributions to the OD flow clustering problem, although two defects remain in existing work. First, few studies can handle arbitrarily shaped OD flow clusters because most algorithms use regularly shaped regions to search for adjacent flows (Nanni and Pedreschi 2006, Zhu et al. 2013, Zhu and Guo 2014). Although certain density-based clustering methods can work on arbitrarily shaped clusters of point process data (Pei et al. 2008), managing OD flow data is still difficult because shapes in OD flow space are arbitrary. Second, the statistical significance of OD flow clusters is rarely considered in the clustering process, although it is a useful indicator for describing the intensity of OD flow clustering." -->

# Discussion

## Spatial concentrations of travel demand

The success of DRT schemes is subject to their ability to serve spatial concentrations of travel demand [@enoch2006demand]. By leveraging a density-based clustering algorithm, our analysis can identify groups of OD flows with sufficiently similar patterns, each of which can be served by a different DRT scheme. The identified clusters predominantly connect urban cores with rural peripheries, underscoring the importance of DRT in complementing fixed-route transit systems, especially in areas with low public transport accessibility and relatively low travel demand.

The clustering algorithm used requires the input of two parameters: epsilon (the search radius) and minpts (the minimum number of points inside the radius necessary for a cluster to form). A parameter sweep is done to determine feasible parameter combinations . @fig-dbscan-sensitivity shows the parameter combinations that successfully resulted in grouping the flows into clusters. We find that clusters are only formed in the epsilon range between 6 and 9. Within that range, the number of clusters returned decreases as minpts is increased, which is to be expected since a higher minimum points value means the threshold for cluster formation is higher. We find that the lowest values for minpts returns clusters that are too disaggregated and fail to capture similar demand patterns. We choose a value of 75 as it returns clusters that are sufficiently distinct and yet not too disaggregate as to be meaningless.

In the absence of established theoretical framework for this approach, we adopt an iterative and exploratory method to parameter setting. Future work should explore more robust methods, or link the method to research on DRT demand requirements. Additionally, different density-based clustering algorithms such as HDBSCAN [@tao2017flowhdbscan] and OPTICS [@fang2021adaptive] can also be explored. Both of these algorithms require only one input parameter and can identify cluster formation at different scales. Identifying clusters at different scales can provide results that are well--suited to variations in population density and can also allow researchers and practitioners to compare different options for the same area.

\-\-\-\-- EMBED THIS SECTION (START)

Flow normalization gives us distances that cover a smaller range. This is useful for our clustering algorithm (DBSCAN), which takes one value for the search radius. If we don't normalize the flows, our distance metric will have a wider range, but we would not be able to choose a search radius that accommodates all the flows (a smaller radius would produce better results for shorter flows, and a larger search radius would produce distorted clusters that group the shorter flows with the longer ones). To overcome the issue of scale associated with OD flows of various lengths, the following research directions could be explored:

-   Improvements to the current distance metric: try other approaches to flow normalization such as transformations to the denominator that reduce the effect of the OD length (e.g. log transformations). A paramater that explicitly represents flow bearing could also be used to reduce circular variance inside each cluster.

-   Clustering at different scales: An alternative to altering the current distance metric is to cluster at different scales. this could be done by partitioning the data by length and running DBSCAN separately for each subgroup, or by using different density-based clustering algorithms such as HDBSCAN [@tao2017flowhdbscan] and OPTICS [@fang2021adaptive]. Both of these algorithms can identify cluster formation at different scales, allowing us to extract clusters of different lengths without worrying about distance normalization in our distance metric.

<!--# Identifying clusters at different scales can provide results that are well–suited to variations in population density -->

-   Using different distance metrics: Metrics such as Frechet distance [@eiter1994computing] could be used. The Frechet distance measures curve similarity by determining minimum "leash" length needed to traverse both curves simultaneously.

<!--# or Hausdorff distance -->

\-\-\-\-- EMBED THIS SECTION (END)

<!--# What if we changed alpha and beta? What would we learn? Why would we focus specifically on origins or destinations? -->

<!--# comment on sensitivity analysis? How can minpts be informed by literature on min / max number of people required for a DRT? -->

![Parameter sweep for DBSCAN algorithm](images/sensitivity_analysis_eps_minpts_filtered.png){#fig-dbscan-sensitivity}

<!--# comment on differences between ODs and ODsd -->

## Implications for strategic planning of DRT

The composition and spatial extent of these clusters inform the design and operation of DRT services. Clusters vary in terms of the number and characteristics of OD pairs they encompass, supporting the evidence that DRT solutions need to be tailored to the area they are serving. Clusters that cover a large area may require many-to-many services that connect to multiple fixed-route transit stops, whereas clusters with a high concentration of commuters in a small area may require more direct services to one or two stops, while clusters with dispersed demand patterns may benefit from flexible, many-to-many DRT services.

Essential to our analysis is the use of DRT as part of an intermodal transport offering. It is clear that our clusters often overlap with high-frequency FRT [@fig-cluster-scenario-3], highlighting the potential for DRT to act as a feeder service. By limiting DRT coverage to areas that are not covered by a high-frequency FRT (step 6 in @fig-workflow), we aim to minimize unnecessary mode shift (e.g. PT to DRT) and enhance the efficiency of public transport systems. Intermodal routing has only recently become possible in agent-based transport simulations [@haslebacher2018intermodal], with the integration of DRT into this intermodal framework being a subsequent development [@chouaki2023agent]. Such a framework should be used to test the feasibility of our DRT zones in facilitating intermodal trips, but it should be noted that the success of such integration is dependent on other factors besides operating zones, such as seamless transfers and fare structures that do not penalise the use of multiple modes.

<!--# Simulations are necessary to inform which solution is more suitable. Discrete event simulations (citation) can be used to inform DRT efficiency under different operating characteristics. More sophisticated agent-based models could help us understand how -->

## Limitations and future work

<!--# THIS DOESN'T NEED TO BE A STAND-ALONE SECTION - BETTER TO EMBED PARAGRAPHS IN OTHER DISCUSSION SUBSECTIONS -->

The method can be further improved by adding a temporal element to the travel demand and carrying out spatiotemporal clustering [@yao2018stepwise; @yan2023spatiotemporal]. This would allow us to identify how DRT operating areas could differ throughout the day or on weekdays/weekends. More spatially disaggregated flow data would also help handle the Modifiable Areal Unit Problem (MAUP), which is only partially mitigated in our case by jittering the aggregated flow data.

The candidate zones identified by the method vary in size, and a follow up exercise would be necessary to validate them. Analytical models mentioned in @sec-planning_drt could be used to determine more precise service areas. They could identify whether the critical demand density for a DRT service is met [@quadrifoglio2009methodology], look at schedule coordination with FRT [@sivakumaran2012cost], and predict DRT performance based on the street network layout in the different zones [@chandra2013new]. Future work could also explore where bus services could be added instead of taking the bus network as a fixed constraint [@pinto2020joint].

## Conclusion

The need to decarbonise the transport sector and improvements in real-time routing technology and the proliferation of app-based services have contributed to a surge in DRT services. However DRT services continue to suffer from the lack of robust strategic level planning, and many fail to capture sufficient passenger demand to make them economically viable.

Strategic planning of DRT that accounts for its integration with more traditional public transport systems presents a promising avenue for improved mobility in areas with pockets of concentrated travel demand that is difficult to serve cost-effectively by fixed-route transit. This work offers both conceptual and methodological contributions that can help realise this promise. Conceptually, we borrow methods from spatial data mining and argue that they are well suited to filling gaps in the current approaches for strategic planning of DRT services. We build on this concept methodologically by embedding a clustering algorithm into a larger transport planning pipeline with more traditional supply and demand components.

Our findings show that this approach holds promise for delineating operating zones in strategic DRT planning.

\pagebreak

# References
