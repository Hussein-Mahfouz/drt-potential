---
title: "Exploring the Potential for Integrating Demand Responsive Transport with Public Transport"
author: "Hussein Mahfouz"
abstract: "Demand-Responsive Transport (DRT) has emerged as a mobility option for areas that are traditionally hard to serve by high frequency public transport. The integration of DRT with public transport could help in reducing car mode share, but planning DRT remains challenging; many studies show that DRT can inadvertantly reduce public transport demand while also increasing congestion and vehicle-miles traveled (VMT).  More research is needed on how to constrain operating areas of DRT based on the unique demand patterns of an area. This work investigates delineating service areas of DRT using spatial clustering of spatial flow data. A density-based clustering method for bivariate flows is used to study commuting patterns by car and public transport in the city of Leeds. We consider clusters based on public transport supply and potential demand. The method identifies clusters of OD flows where demand is concentrated. The areas identified provide a useful input into additional simulations that aim to further refine the operating characteristics of DRT."
date: "`r format(Sys.time(), '%d %m %y')`"
format:
  #gfm: default
  # html:
  #   toc: true
  docx:
    toc: false
    number-sections: true
  # pdf:
  #   toc: false
  #   number-sections: false
  #   extra_dependencies: ["float"]
    #pdf-engine: pdflatex
keep-tex: true
bibliography: lit-review.bib
# elsevier style for referencing (from https://github.com/citation-style-language/styles)
csl: elsevier-harvard.csl
# so that figures don't float around
# include-in-header:
#  \usepackage{float}
#  \floatplacement{figure}{H}
 # to add acronyms (only works for pdf output)
filters:
  - pseudocode
---

```{r, include = FALSE}
#library(tidyverse)
knitr::opts_chunk$set(fig.pos = "H", out.extra = "")
```

# Introduction {#sec-intro}

Research on DRT planning has focused more on the tactical and operational level and less on the strategic level [@papanikolaou2017methodological]. Strategic level methods that help identify potential DRT operating zones are important given that one of the main determinants of success for a DRT scheme is its ability to concentrate demand in time and geography [@enoch2006demand].

This study makes both conceptual and methodological contributions to the strategic level planning of DRT services. Conceptually, it fills a important gap in strategic DRT planning by addressing an unexplored area: the identification of clusters in commuting flows and their implications for DRT service operating areas. Methodologically, the study introduces a spatial statistical approach to cluster spatial flow data [@tao2016spatial], and combines it with an assessment of transport supply and demand to identify areas with concentrated travel demand suitable for DRT services. This framework ensures that DRT is not proposed in areas where there is no concentrated demand, and where an improved Fixed Route Transit (FRT) would be more appropriate.

## Planning DRT systems {#sec-planning_drt}

Various elements of DRT operating characteristics, including fares, fleet size and rebalancing, and operating zones affect its uptake and the broader transport system. Analytical models exist for deciding whether areas should be served by a FRT or DRT, but these models are based on idealized representations at the route level with pre-defined service areas [@quadrifoglio2009methodology; @li2010feeder; @sivakumaran2012cost]. For these models to be applied in a real case study, it is important to first identify potential service areas in an actual network.Â 

Simulation-based approaches have looked at potential DRT service areas based on public transport accessibility [@kaddoura2020impact; @rath2023assessing; @oke2020evaluating]. High variance in mode share from these different simulation results shows that generic rules based on accessibility levels cannot be applied to all cities. To reduce car usage and overall VMT, DRT service areas must be informed by spatial and temporal demand patterns in the region [@kagho2021demand].

## Identifying spatial concentrations in travel demand

Clustering has emerged as a method for spatial pattern identification in OD data. Density-based clustering [@ester1996density] relies on distances between observations and is primarily used for point data. @tao2016spatial devised a measure to calculate distance between lines, and this has paved the way for similar algorithms to be applied to flow data [@tao2016dbscan; @tao2017flowhdbscan; @fang2021adaptive].

# Methods {#sec-methods}

Our entire workflow is presented in @fig-workflow.

![Workflow for generating potential DRT zones](images/figure_entire_workflow.png){#fig-workflow}

## Clustering flow data {#sec-method-clustering-flow-data}

We apply a spatial clustering approach to flow data to identify spatial concentrations in travel demand. For demand, we use OD commuting (flow) data from the 2021 UK census [@ons2023flow]. We use the DBSCAN algorithm with the custom distance metric introduced by @tao2016spatial: let the flow process $F_{i}$ with origin $O_{i} (x_{i}, y_{i})$ and $D_{i} (u_{i}, v_{i})$ be modeled as a vector point with 4 coordinates $F_{i}(x_{i}, y_{i}, u_{i}, v_{i})$. The calculation for flow dissimilarity ($FDS_{ij}$) between $F_{i}$ and $F_{j}$ is shown in @eq-fds.

$$FDS_{ij} = \sqrt{\frac{\alpha[(x_{i} - x_{j})^2 + (y_{i} - y_{j})^2] + \beta [(u_{i} - u_{j})^2 + (v_{i} - v_{j})^2]}{L_{i}L_{j}}}$$ {#eq-fds}

where $\alpha$ and $\beta$ control the relative importance of the origins / destinations: higher $\alpha$ means we focus more on origins and vice-versa ($\alpha > 0$; $\beta > 0$; $\alpha + \beta = 2$). Dividing by the geometric mean of the flow lengths ($L_{i}$ and $L_{j}$ ) implies that, all else being equal, flow pairs of longer length are considered closer than shorter ones.

## Accounting for transport supply and demand

The cluster composition is heavily influenced by the input data. To identify DRT zones that complement FRT and fill network gaps, we exclude OD pairs well-served by FRT (to get $OD_s$) and those that could be better served by improved FRT (to get $OD_{sd}$). The workflow is show in @fig-flowchart-scenarios.

![Flowchart for determining input to clustering algorithm](images/flowchart_od_potential_demand.png){#fig-flowchart-scenarios}

A supply analysis uses the updated road network from OSM, bus timetable data from the Bus Open Data Service (BODS) and rail data from the Rail Delivery Group. A multimodal routing engine [@pereira2021r5r] is used to calculate travel time between zones. OD pairs with speed below the 50th percentile (calculated using Euclidian distance) or that require more than one transfer to be reached by public transport are considered to have poor supply.

The demand analysis is meant to identify FRT routes that warrant an increase in route frequency. We calculate potential demand on all routes, and identify routes that have sufficient potential demand to warrant said increase in frequency. Route-level potential demand is estimated by assigning demand from each OD pair equally between its common lines (see @de2024modelling10 for overview of methods).

# Results

We apply our method to Leeds (UK), a city with high ambitions for increasing public transport mode share [@wyca2021connectivity].

The clustering results are visualized using a dashed border, and the colored polygons are used to show potential DRT service areas that could cover parts of each cluster [@fig-cluster-scenario-3]. In most cases, the clusters partially overlap with the high frequency FRT services, but that is because the FRT service does not meet the demand at its endpoints. A DRT service in these cases would be more useful as a connector to the FRT service, not as a parallel service.

![Clustering results ($OD_{sd}$) - dashed border represents initial clusters, and colored polygons represent potential DRT service areas that could cover parts of each cluster.](images/map_clusters_scenario_3_equal_length_50000_bus_frac_grouped_gtfs_poly_lines_bus_diff_concave2.png){#fig-cluster-scenario-3}

Many of the clusters join up the urban core with its rural periphery. This is in line with research showing that DRT services can be used to compliment FRT systems that extend to rural areas [@sorensen2021much; @schluter2021impact].

Comparing the original clusters to the extracted DRT operating zones, we see how the latter cover much less urban areas than the former [@fig-cluster-stats]. The operating zones are meant to connect to the high frequency FRT network, and limiting the DRT service to the urban periphery is important for limiting unnecessary mode shift.

::: {#fig-cluster-stats layout-ncol="2"}
![](images/figure_bar_urban_rural_compare_filter_no_filter_facet_cluster_scenario_3_length_50000.png){width="300"}

![](images/figure_scatter_commuters_color_speed_facet_cluster_scenario_3_length_50000.png){width="300"}

Left: Classification of areas covered by each \| Right: Characteristics of OD pairs in each cluster (light grey are all OD pairs and dark grey are all OD pairs in the cluster with no viable public transport option)
:::

# Conclusion

The composition and spatial extent of these clusters inform the design and operation of DRT services. Clusters vary in terms of the number and characteristics of OD pairs they encompass, suggesting the need for tailored DRT solutions. For example, clusters with a high concentration of commuters may require more direct DRT services, while clusters with dispersed demand patterns may benefit from flexible, many-to-many DRT services.

An important aspect of our analysis is the integration of DRT with existing fixed-route transit networks. We observed that DRT service areas often overlap with high-frequency fixed-route bus networks, highlighting the potential for DRT to act as a feeder service. By limiting DRT coverage to urban peripheries and rural areas, we aim to minimize unnecessary mode shift and enhance the efficiency of public transport systems.

The method can be further improved by adding a temporal element to the travel demand and carrying out spatiotemporal clustering [@yao2018stepwise; @yan2023spatiotemporal]. Further research is also needed to validate the zones, and analytical models could be used to identify whether the critical demand density for a DRT service is met [@quadrifoglio2009methodology], look at schedule coordination with FRT [@sivakumaran2012cost], and predict DRT performance based on the street network layout in the different zones [@chandra2013new].

\pagebreak

# References
